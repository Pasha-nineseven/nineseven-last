<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>test</title>
		<!-- <link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32" />
		<link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16" /> -->
		<link href="css/libs.min.css" rel="stylesheet">
		<link href="css/style.css" rel="stylesheet">
		<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
	</head>
	<body>
		<!--LAYOUT-->
		<div class="layout">
			<header class="page-header">
				<div class="container-fluid">
					<div class="page-header__wrap">
						<a href="#" class="top-logo"></a>
						<a href="#" class="menu-btn">
							<span class="burger-icon"></span>
						</a>
						<nav class="top-nav">
							<a href="#" class="top-nav__item">Кейсы</a>
							<a href="#" class="top-nav__item">Компания</a>
							<a href="#" class="top-nav__item">Контакты</a>
							<a href="#" class="top-nav__item">Автодилерам</a>
							<a href="#" class="top-nav__item">Аналитика</a>
						</nav>
					</div>
				</div>
			</header>
			<main class="page-content workarea">
				<div class="container-fluid">
					<div class="case-top animated_el m-bottom">
						<div class="indent">
							<div class="case-top__wrap">
								<div class="case-top__icon">
									<img src="img/svg/abamet.svg" alt="">
								</div>
								<div class="case-top__txt">
									Компания «Абамет» более 25 лет осуществляет поставки металлообрабатывающего оборудования. По сегодняшний день мы остаются единственной компанией в своём сегменте, которая дает возможность заказать, оплатить онлайн и получить доставку. Весь жизненный цикл продажи автоматизирован.
								</div>
							</div>
						</div>
					</div>
					<div class="page-title animated_el m-title">
						<div class="indent">
							<h1>
								Разработка интернет-магазина и<br> интеграций для Abamet-shop.ru
							</h1>
						</div>
					</div>
					<!-- CONTENT-PART -->
					<div class="incut animated_el m-bottom">
						<div class="indent">
							<div class="incut__inner">
								В 2016 нам обновить визуальный стиль проекта и упростить его структуру. Навигация была неудачной, клиенты просто терялись в каталоге, а поиск не всегда находил нужные позиции.
							</div>
						</div>
					</div>
					<div class="case-pre animated_el m-bottom">
						<div class="indent">
							<div class="case-pre__in">
								<p>
									Мы переделали структуру каталога, обновили навигацию и совместно с клиентом обновили вложенность разделов. Сделали новый визуальный стиль и стилизацию остальных разделов под него.
								</p>
								<p>
									На обновлении стиля дело не закончилось, поэтому данный кейс больше про автоматизацию процессов, а не новые шаблоны.
								</p>
							</div>
						</div>
					</div>

					<div class="case-compare animated_el m-bottom">
						<div class="indent">
							<div class="row case-compare__wrap">
								<div class="col-lg-6 case-compare__item">
									<div class="case-compare__title">Было:</div>
									<div class="case-compare__img">
										<img src="img/content/abamet1.jpg" alt="">
									</div>
								</div>
								<div class="col-lg-6 case-compare__item">
									<div class="case-compare__title">Стало:</div>
									<div class="case-compare__img">
										<img src="img/content/abamet2.jpg" alt="">
									</div>
								</div>
							</div>

							<div class="row case-compare__wrap">
								<div class="col-lg-4 case-compare__item">
									<div class="case-compare__img">
										<img src="img/content/abamet3.jpg" alt="">
									</div>
								</div>
								<div class="col-lg-4 case-compare__item">
									<div class="case-compare__img">
										<img src="img/content/abamet4.jpg" alt="">
									</div>
								</div>
								<div class="col-lg-4 case-compare__item">
									<div class="case-compare__img">
										<img src="img/content/abamet5.jpg" alt="">
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="plan animated_el m-bottom">
						<div class="indent">
							<h3>Планируем архитектуру обмена</h3>
							<div class="row plan-top">
								<div class="col-lg-6 plan-top__item">
									В 2019 решили уходить от старой системы SAP на новую связку ERP+CRM. В качестве систем интеграции были выбраны 1C как ERP, и Microsoft Dynamics как CRM. 
								</div>
								<div class="col-lg-6 plan-top__item">
									За данную связку отвечал интегратор «Корус Консалтинг». Нашей задачей было внедрить в эти процессы интернет-магазин.
								</div>
							</div>
							<div class="plan__list">
								<div class="plan__item">
									<div class="plan__in">
										<div class="plan__title">1C</div>
										<div class="plan__txt">
											<p>Отдаёт номенклатуру, остатки, описание и фотографии товаров.</p>
											<p>Принимает остатки, заказы, статусы заказов.</p>
										</div>
									</div>
								</div>
								<div class="plan__item">
									<div class="plan__in">
										<div class="plan__title">Интернет-магазин</div>
										<div class="plan__txt">
											<p>Принимает каталог, товары, уровни скидок.</p>
											<p>Отдаёт заказы, пользователей, статусы заказов, остатки по складам.</p>
										</div>
									</div>
								</div>
								<div class="plan__item">
									<div class="plan__in">
										<div class="plan__title">Microsoft Dynamics</div>
										<div class="plan__txt">
											<p>Принимает информацию по клиентам: физики, юрики</p>
											<p>Отдаёт уровни скидок, статистику по бонусам.</p>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>


					<div class="optimization animated_el m-bottom">
						<div class="indent">
							<h3>Обмен по протоколу SOAP</h3>
							<div class="optimization__msg">
								<p>
									SOAP это старый и сложный протокол обмена который устоялся в 1С, поэтому часто для обменов с 1С используют именно его, а не более свободный по реализации REST.
								</p>
								<p>
									В общем виде обмен выглядит так:
								</p>
							</div>
							<div class="optimization__list">
								<div class="optimization__item">
									<div class="optimization__in">Сервер 1С</div>
								</div>
								<div class="optimization__item">
									<div class="optimization__in">Единая точка входа для всех методов</div>
								</div>
								<div class="optimization__item">
									<div class="optimization__in">
										WSDL-файл
									</div>
								</div>
								<div class="optimization__item">
									<div class="optimization__in">
										Soap-сервис на PHP или модуле Битрикс
									</div>
								</div>
							</div>
							<div class="row optimization-more">
								<div class="col-lg-6 optimization-more__item">
									В отличие от REST на SOAP формируется одна точка входа, а за маршрутизацию методов отвечает специальный WSDL-файл. Это xml-файл который описает методы и их структуру.
								</div>
								<div class="col-lg-6 optimization-more__item">Реализации SOAP есть как на PHP так и у Битрикса. Но модуль битрикса давно не обновлялся, поэтому мы делали сборку на SOAP-PHP. </div>
							</div>
						</div>
					</div>


					<div class="p-roadmap animated_el m-bottom">
						<div class="indent">
							<h3>Планируем дорожную карту</h3>
							<div class="optimization__msg">
								При построении сложных обменов главное правильно начать. Нужно строить обмен от базового. Логичнее всего в магазине было начать именно с каталога, и потом добавлять к нему всё остальное.
							</div>

							<div class="p-roadmap__wrap">
								<div class="p-roadmap__item">
									<div class="p-roadmap__in">
										<div class="p-roadmap__top">1-й этап</div>
										<div class="p-roadmap__txt">
											Разработка SOAP-сервера для приёма категорий и товаров.
										</div>
									</div>
								</div>
								<div class="p-roadmap__item">
									<div class="p-roadmap__in">
										<div class="p-roadmap__top">2-й этап</div>
										<div class="p-roadmap__txt">
											Создание SOAP-клиента для передачи остатков из корзины
										</div>
									</div>
								</div>
								<div class="p-roadmap__item">
									<div class="p-roadmap__in">
										<div class="p-roadmap__top">3-й этап</div>
										<div class="p-roadmap__txt">
											Создание SOAP-клиента для передачи клиентов в CRM
										</div>
									</div>
								</div>
								<div class="p-roadmap__item">
									<div class="p-roadmap__in">
										<div class="p-roadmap__top">4-й этап</div>
										<div class="p-roadmap__txt">
											Создание SOAP-сервера для приёмки уровней скидок
										</div>
									</div>
								</div>
								<div class="p-roadmap__item">
									<div class="p-roadmap__in">
										<div class="p-roadmap__top">5-й этап</div>
										<div class="p-roadmap__txt">
											Создание SOAP-методов для отдачи информации о заказах
										</div>
									</div>
								</div>
							</div>

							<div class="optimization__msg">
								Этапность строилась таким образом, что после каждого этапа происходила синхронизация баз данных, и пример когда мы делали реализацию передачи заказов, 1С уже понимала какие товары покупает клиент.
							</div>
						</div>
					</div>

					<div class="optimization animated_el m-bottom">
						<div class="indent">
							<h3>Защита и унификация обмена между тремя системами</h3>
							<div class="optimization__msg">
								<p>
									Для реализации безопасного обмена используется два уровня:
								</p>
							</div>
							<div class="optimization__list">
								<div class="optimization__item">
									<div class="optimization__in">Запрос</div>
								</div>
								<div class="optimization__item">
									<div class="optimization__in">Валидация Basic Auth на уровне сервера</div>
								</div>
								<div class="optimization__item">
									<div class="optimization__in">
										Валидация по systemID на уровне пакета
									</div>
								</div>
							</div>
							<div class="row optimization-more">
								<div class="col-lg-6 optimization-more__item">
									Чтобы запрос прошёл, нужно чтобы вместе с передачей xml-пакета у системы был правильный basic auth заголовок. Если заголовок корректный, система проверяет валидность ключа обмена. Если ключ в пакете некорректный запрос отбраковывается.
								</div>
							</div>
						</div>
					</div>

					<div class="optimization animated_el m-bottom">
						<div class="indent">
							<h3>Схема идентификации</h3>
							<div class="optimization__msg">
								<p>
									В процессе задействованы три базы данных, а это значит что у каждой своя структура и логика хранения данных. Чтобы у систем была сквозная синхронизация и единые сущности индентифицировались одинаково, мы хранили все наборы идентификаторов.
								</p>
								<p>
									Каждая сущность обмена описывалась например так:
								</p>
							</div>
							<div class="essence">
								<div class="essence__item"><span>ID_ERP:</span>d1f5d2ce-4732-11e9-8dac-005056032acc</div>
								<div class="essence__item"><span>ID_CRM:</span>752df240-ff4a-e911-a83c-000d3ab2daff</div>
								<div class="essence__item"><span>ID_IM:</span>513-404-10e</div>
								<div class="essence__item"><span>ID_SAP:</span>513-404-10E</div>
							</div>
							<div class="row optimization-more">
								<div class="col-lg-6 optimization-more__item">
									Это удобно, так как при обмене, например товаром, каждая система знает, какой объект к ней пришел.
								</div>
							</div>
						</div>
					</div>

					<div class="optimization animated_el m-bottom">
						<div class="indent">
							<h3>Контуры обмена с 1С</h3>
							<div class="row">
								<div class="col-lg-6 optimization-more__item">
									1С хранит информацию о каталоге, при этом не только о товарах, но о категориях, об уровнях вложенности, а так же SEO-описания для категорий.
								</div>
								<div class="col-lg-6 optimization-more__item">Кроме того, 1С отвечает и за бух. учет, поэтому информация о заказах поступает из ИМ напрямую в 1С. </div>
							</div>
							<br>
							<br>
							<h4>
								Обмен с 1С проще всего показать на примере товара
							</h4>
							<div class="cont-sqheme">
								<img src="img/svg/sqh2.svg" alt="">
							</div>
							<h4>
								Как описывать обмен для разработчика и не облажаться?
							</h4>
							<div class="optimization__msg">
								ТЗ нужно разделить на три части (вырезки и рабочего ТЗ):
							</div>
							<div class="row case-compare__wrap">
								<div class="col-lg-4 case-compare__item">
									<div class="case-compare__title">Описание порядка обмена по шагам, или в виде UML-диаграммы:</div>
									<div class="case-compare__img">
										<img src="img/content/abamet6.jpg" alt="">
									</div>
								</div>
								<div class="col-lg-4 case-compare__item">
									<div class="case-compare__title">Формат данных из пакета и соответствие записи в БД на стороне магазина:</div>
									<div class="case-compare__img">
										<img src="img/content/abamet7.jpg" alt="">
									</div>
								</div>
								<div class="col-lg-4 case-compare__item">
									<div class="case-compare__title">Пример запроса и ответа в формате обмена:</div>
									<div class="case-compare__img">
										<img src="img/content/abamet8.jpg" alt="">
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="dest animated_el m-bottom">
						<div class="indent">
							<h4>Суммарно был реализованы следующие направления обмена</h4>
							<div class="dest__wrap">
								<div class="dest__item">Структура каталога</div>
								<div class="dest__item">Цены</div>
								<div class="dest__item">Заказы</div>
								<div class="dest__item">Товары</div>
								<div class="dest__item">Остатки</div>
								<div class="dest__item">Статусы заказов</div>
								<div class="dest__item">SKU</div>
								<div class="dest__item">Изображения и pdf</div>
								<div class="dest__item">Характеристики товаров</div>
							</div>
						</div>
					</div>

					<div class="optimization animated_el m-bottom">
						<div class="indent">
							<h3>Контуры обмена с Microsoft Dynamics 365</h3>
							<div class="row">
								<div class="col-lg-6 optimization-more__item">
									CRM в первую очередь работает с клиентам компании. В магазин и из магазина мы передаём информацию о клиентах, как о физ.лицах так и юр.лицах.
								</div>
								<div class="col-lg-6 optimization-more__item">Кроме того следим за объёмами их покупок, уровнями скидок.</div>
							</div>
							<br>
							<br>
							<h4>Обмен с CRM происходит по следующей схеме</h4>
							<div class="k-sqheme">
								<img src="img/svg/k-sqheme.svg" alt="">
								<div class="k-sqheme__msg">
									<p>
										Сложность при интеграции с CRM, в особенностях хранения сущеностей в двух системах. В Битрикс покупатель, это единая сущность, и 1 запись в базе данных. А тип покупателя, как физ.лицо или юр.лицо уже определяется на уровне заказа, как профиль покупателя.
									</p>
									<p>
										В CRM иерархия сложнее, так как есть сущность компания, в неё могут входить любое количество клиентов. Клиент не хотел ломать текущую схему хранения покупателей, поэтому мы написали скрипт который расширял хранимые данные по пользователям, и передавал их в единообразом виде в CRM, где уже система сама распределяла компании и клиентов как разные сущности.
									</p>
								</div>
							</div>
						</div>
					</div>

					<div class="optimization animated_el m-bottom">
						<div class="indent">
							<h3>Сервер очередей</h3>
							<div class="row">
								<div class="col-lg-6 optimization-more__item">
									Так как все три учетные системы ИМ, 1С и CRM находятся на разных серверах, и обмениваются инфомацией по сети, нужно было предусмотреть минимальный сервер очередей для огранизации отправки повторных сообщений при получении ошибок или сетевой недоступности.
								</div>
								<div class="col-lg-6 optimization-more__item">
									Готовые решения, вроде RabbitMQ слишком громозкие для нашей микрозадачи, поэтому мы написали свой скрипт и агента который работает с пакетами сообщений.
								</div>
							</div>
							<br>
							<br>
							<h4>Схема работы сервиса</h4>
							<div class="service-sqheme">
								<div class="service-sqheme-top">
									<div class="service-sqheme-top__item">
										<div class="service-sqheme-top__in">Скрипт слушает все коды ошибок</div>
									</div>
									<div class="service-sqheme-top__item">
										<div class="service-sqheme-top__in">При возникновении ошибки событие логгируется вместе с методом и записывается в инфоблок с меткой времени</div>
									</div>
									<div class="service-sqheme-top__item">
										<div class="service-sqheme-top__in">Если метка времени в логе инфоблока по событию старше лимита в настройках, то пробуем отправить повторно</div>
									</div>
								</div>
								<div class="service-sqheme__img">
									<img src="img/content/abamet9.jpg" alt="">
								</div>
							</div>
						</div>
					</div>

					<div class="plan animated_el m-bottom">
						<div class="indent">
							<h3>Класс работы с логами</h3>
							<div class="row plan-top">
								<div class="col-lg-6 plan-top__item">
									Кроме реализации самого обмена, важным нюансом было выстроить корректную систему логгирования событий не только для сервера очередей, но и для каждого контура обмена в целом.
								</div>
								<div class="col-lg-6 plan-top__item">
									Сложности с логгированием обычно в том, что неопытные проектировщики оставляют логгирование на откуп разработчику, поэтому можно получить несвязную кучу логов которое копятся годами.
								</div>
							</div>
							<h4>Как функции выполняет класс работы с логами</h4>
							<div class="class-list">
								<div class="dest__item">Единая структура логгирования событий</div>
								<div class="dest__item">Единый формат</div>
								<div class="dest__item">Единая машрутизация логов</div>
								<div class="dest__item">Единые правила именования по суткам</div>
								<div class="dest__item">Сборка мусора (логи старше недели удаляются)</div>
							</div>
						</div>
					</div>

					<div class="team animated_el m-bottom">
						<div class="indent">
							<h3>Команда проекта</h3>
							<div class="team__wrap">
								<div class="team__item">
									<div class="team__line">
										<div class="team__top">Руководитель проекта</div>
										<div class="team__person">Дима Хоружко</div>
									</div>
								</div>
								<div class="team__item">
									<div class="team__line">
										<div class="team__top">PHP разработчики</div>
										<div class="team__person">Денис Иванов</div>
										<div class="team__person">Руслан Кадыров</div>
									</div>
								</div>
								<div class="team__item">
									<div class="team__line">
										<div class="team__top">Команда клиента</div>
										<div class="team__person">Дмитрий Сенькевич</div>
										<div class="team__person">Владимир Киселев</div>
									</div>
								</div>
								<div class="team__item">
									<div class="team__line">
										<div class="team__top">Архитектор обмена</div>
										<div class="team__person">Дима Хоружко</div>
									</div>
								</div>
								<div class="team__item">
									<div class="team__line">
										<div class="team__top">Команда Webcom Media</div>
										<div class="team__person">Татьяна Снитич</div>
										<div class="team__person">Светлана Валяк</div>
									</div>
								</div>
							</div>
						</div>	
					</div>
					<!--end CONTENT-PART -->
				</div>
			</main>
		</div><!-- END LAYOUT-->
		<footer class="page-footer">
			<div class="container-fluid">
				<div class="indent">
					<div class="page-footer__wrap">
						<div class="page-footer__view">
							<nav class="page-footer__nav">
								<a href="#" class="page-footer__link">О компании</a>
								<a href="#" class="page-footer__link">Кейсы</a>
								<a href="#" class="page-footer__link">Как мы работаем</a>
								<a href="#" class="page-footer__link">Автодилерам</a>
								<a href="#" class="page-footer__link">Эл.коммерции</a>
								<a href="#" class="page-footer__link">Дизайн</a>
								<a href="#" class="page-footer__link">Разработка</a>
								<a href="#" class="page-footer__link">Интеграции</a>
							</nav>
							<div class="page-footer__b">
								<div class="copyright">
									&copy; 2010 – 2020 Nineseven. Минск, Тимирязева 72/1
								</div>
								<div class="page-footer__add">
									<a href="img/svg/logo.svg" class="presentation" download>
										Перезентация компании
									</a>
									<a href="http://www.youtube.com/embed/Xzk_U9E9jQU?&autoplay=1" class="show-link js-play-btn">
										Шоурил 2019 – 2020
									</a>
								</div>
							</div>
						</div>
						<div class="page-footer-socials">
							<a href="#" class="page-footer-socials__item m-fb"><span></span></a>
							<a href="#" class="page-footer-socials__item m-insta"><span></span></a>		
						</div>
					</div>
				</div>
			</div>
		</footer>
			
		

		<script src="js/libs.min.js"></script>
		<script src="js/interface.js"></script>
		<script src="js/pages.js"></script>
	</body>
</html>
